# 第八章 - 防火墙安全策略及其配置

---

## 防火墙如何开发安全策略

#### 什么是安全策略
* 一个有效的防火墙依赖于一个明确清楚的、全面的安全策略。实际上，在设计安全系统时**首先考虑的应该是策略**，而不是防火墙。

* 定义：一个列出必须满足的特定需求或规则的文档

#### 安全策略的重要性
* 防火墙的设计依赖于**被保护资源和那些资源所面临的危险**，两者都包括在安全策略中。

* 策略还告诉建立什么类型的**入侵检测**和**审计系统**

* 应对信息系统的建设，需要引入一种新的管理机制来对信息系统的**安全性、投资效果、实施进程和实施效果**等进行**评估、指导和改进**。这种机制就是**IT审计**

* 审计
    * 为什么要进行网络审计？
        * 我们的网络中到底发生了什么

        * 如何进行事后的追踪
    
        * 如何对网络进行有效的监控
        
        * 如何改进网络的安全策略
    * 网络审计的主要内容：
        * 网络连接审计
        
        * 协议审计
        
        * 端口审计 
        
        * 拨号连接审计 
        
        * 个人帐户审计 
        
        * 文件访问审计  
        
        * 数据审计 
        
        * 流量统计审计 
        
        * 数据库审计 
        
        * WEB服务器审计 
        
        * 安全事件再现审计
        
        * 键盘审计 
        
        * 屏幕审计 
        
        * 系统统计分析
        
* 黑客攻击以及其他未授权的入侵造成的损失：
    * 雇员时间
    
    * 数据丢失
   
    * 生产力

#### 确定有效的安全策略所需达到的目标
* 要清楚地描述一个安全的**网络计算环境**

* 要**灵活适应**公司结构的任何改动

* 要保证在整个公司中**一致地交流和执行**

* 要明确雇员对网络的**使用权限**

* 要对雇员和管理人员关于**隐私和安全的合理和不合理**的表现进行明确定义


#### 构建安全策略的7步
略

#### 考虑防火墙的不足
* 超出防火墙所能处理的**过多的网络访问量**，及其防火墙崩溃的**蛮力攻击**

* 在网络中将一个**加密的带有病毒**的电子邮件消息发送给某人，加密的消息将会**通过防火墙**，这样病毒就会**传染给系统**

* 若雇员将**远程访问号码泄漏**，则未经授权的用户就能够访问公司网络

* 防火墙属于**静态防护**

* 防火墙**难于防内**

* 防火墙难于管理和配置，易造成**安全漏洞 **

* 防火墙的安全控制主要是**基于IP地址**的，难于为用户在防火墙内提供一致的安全策略

* 防火墙只实现了**粗粒度**的访问控制，且不能与企业内部使用的其它安全机制（如访问控制）集成使用

* 任何一个系统（尤其是底层系统和应用系统）中可能存在着**安全漏洞，造成绕过防火墙的攻击** 

#### 其他安全策略主题

#### 定义针对违反安全规则的响应
* 记录数据

* 响应处理联系人

* 响应策略

#### 克服管理的障碍
* 雇员的培训

* 呈交并回顾制定过程

* 改进安全策略

## 防火墙配置概述
* 非法数据包渗透一个应用得当、配置完善的防火墙是十分困难的。

* 在实际应用中人们一方面对网络安全的意识十分薄弱，另一方面在网络安全产品尤其防火墙的配置策略中漏洞百出，因此给网络攻击者可乘之机

## isco IOS防火墙特征集
* 基于Cisco IOS的防火墙特性集（FFS，Firewall Features Set），能够实现对Cisco路由器提供附加的安全功能，方便地实现边界安全部署。

* IOS FFS的优势在其子接口类型、端口密度、性能以及形态元素（即大小、形式和容量）方面巨大的灵活性

* Cisco IOS FFS的核心是基本防火墙工具——**基于上下文的访问控制(Context-based Access Control，CBCA)**
    * CBCA是一种**状态检查防火墙**，作为路由器的操作系统IOS的附加特性集运行。
    
    * CBCA实现了防火墙的一些重要功能和服务



## 配置Cisco IOS防火墙包过滤功能
* 在Cisco IOS防火墙特征集中集成了很强的**防火墙功能**和**人侵检测功能**。

* Cisco IOS防火墙包过滤技术依赖于**访问控制列表（ACL，Access Control List）**。
根据对数据包检查的粒度， Cisco IOS防火墙将访问控制列表分为两类：**标准访问控制列表**和**扩展访问控制列表**。

* 根据功能和特点，访问控制列表还可以分为：**静态访问控制列表、动态访问控制列表和反射访问控制列表**

* 字符串模式匹配

#### 配置访问控制列表
* Cisco IOS访问控制列表的配置需要遵循两个步骤：
    * 创建访问控制列表
    * 将访问控制列表绑定到某个网络接口
![](http://ouzh4pejg.bkt.clouddn.com/firewall-acl.JPG)

* 配置访问控制列表－－创建访问控制列表

    * 创建访问控制列表就是**向某个访问控制列表中添加命令**的过程。命令的一般格式是: **命令 + 访问控制列表编号 + 操作 + 条件**
    ```javascripe
    # 创建某个访问控制列表并添加一条命令语句
    Router(config)#access-list access-list-number [permit|deny] 测试条件
    
    # 删除某个访问控制列表
    Router(config)#no access-list access-list-number
    ```

* 配置访问控制列表－－绑定访问控制列表到网络接口
   * 创建访问控制列表后必须将其**绑定到Cisco IOS防火墙**或路由器的**某个接口**方能生效。
   
    * 绑定访问控制列表到某网络端口命令
    ```javascript
     //参数protocol指明了是针对哪种协议的访问控制列表。常用的有IP、IPX等。参数in/out表明数据流进入／流出网络接口的方向
    Router(config-if)# protocol access-group access-list-number [in|out]
    ```



#### 翻转掩码
![](http://ouzh4pejg.bkt.clouddn.com/wildcard_bits.JPG)

#### 配置标准访问控制列表
* 标准访问控制列表
    * 用于**允许或者禁止来自于某个网络的所有数据**流，或者**禁止某一协议**的数据流。
    
    * 具体命令略去，见第八周ppt NO.43 - NO.45
* 配置标准访问控制列表
    * 例1：**指定特定网络** ，在防火墙/路由器上，**只允**许来自于网络 171.16.0.0的数据包被转发出去，其余的数据包都将被阻止
    ![](http://ouzh4pejg.bkt.clouddn.com/example-1.JPG)
    
    * 例2: **阻止特定地址**,在防火墙/路由器上，在接口E0**阻止**来自特定地171.16.4.13的数据流，其他的数据流将被转发出去。
    * ![](http://ouzh4pejg.bkt.clouddn.com/example-2.JPG)
    
    * 例3： **阻止特定的子网**，阻止来自于特定子网171.16.4.0的数据通过E0端口，而转发其他的数据
    ![](http://ouzh4pejg.bkt.clouddn.com/example-3.JPG)

    
#### 配置扩展访问控制列表

#### 配置标识访问控制列表

#### 配置动态访问控制列表

#### 访问控制列表配置要点


